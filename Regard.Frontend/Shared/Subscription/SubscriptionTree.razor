<TreeView @ref="treeView"
          Model="SubscriptionItemViewModelBase"
          SelectedItemChanged="OnSelectedItemChanged">
    <ItemTemplate Context="item">
        <a href="#" class="tree-item-expand-button @CssUtils.BoolToClass(item.Children.Count == 0, "v-hidden")"
           @onclick="() => OnExpandToggle(item)" @onclick:stopPropagation="true">
            <Icon Glyph="Icons.ChevronDown" Class="tree-item-expand-icon" />
        </a>
        <div class="tree-subscription-icon">
            @if (item.Data.ThumbnailUrl != null)
            {
                <img src="@item.Data.ThumbnailUrl" />
            }
            else
            {
                <Icon Glyph="item.Data.PlaceholderIcon" />
            }
        </div>
        <div class="tree-subscription-name">
            @item.Data.Name
        </div>
        <a @ref="item.Data.ContextMenuLinkReference" href="#"
           class="tree-subscription-menu @CssUtils.BoolToClass(!item.IsSelected, "v-hidden")"
           @onclick="() => OnShowMenu(item)" @onclick:stopPropagation="true">
            <Icon Glyph="Icons.Menu" />
        </a>
        <Menu AttachTo="item.Data.ContextMenuLinkReference" @bind-IsVisible="item.Data.IsContextMenuVisible">
            <MenuItem Click="() => OnEditItem(item)">Edit</MenuItem>
            <MenuItem Click="() => OnRefreshItem(item)">Refresh</MenuItem>
            <MenuItem Click="() => OnDeleteItem(item)">Delete</MenuItem>
        </Menu>
    </ItemTemplate>
</TreeView>